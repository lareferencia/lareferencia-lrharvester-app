# ==============================================================================
# FLOWABLE ENGINE CONFIGURATION (Manual Configuration)
# ==============================================================================
# 
# IMPORTANT: To enable/disable Flowable, use workflow.engine property in 
# 08-workflow.properties. This file contains Flowable-specific configuration
# that only applies when workflow.engine=flowable.
# ==============================================================================

# Disable Liquibase (Flowable brings it as transitive dependency)
# Flowable uses its own database schema management via database-schema-update property
spring.liquibase.enabled=false

# ------------------------------------------------------------------------------
# Process Deployment
# ------------------------------------------------------------------------------

# Location of BPMN process files (Spring Resource pattern)
# Used by FlowableManualConfiguration to auto-deploy processes
flowable.process.definitions.location=file:config/processes/**/*.bpmn20.xml

# ------------------------------------------------------------------------------
# Database Configuration
# ------------------------------------------------------------------------------

# Flowable datasource (separate database, same server and credentials as main)
# 
# IMPORTANT: Uncomment the appropriate configuration based on your database type.
# Flowable will use the same server and credentials as the main datasource,
# but with a separate database to isolate workflow data.

# ------------------------------------------------------------------------------
# PostgreSQL (Default)
# ------------------------------------------------------------------------------
# IMPORTANT: Spring does not support ${property}_suffix concatenation syntax.
# The URL must be specified explicitly.
# 
# If you change spring.datasource.url, remember to update this URL as well.

flowable.datasource.jdbc-url=jdbc:postgresql://localhost:5432/lrharvester_flowable
flowable.datasource.username=${spring.datasource.username}
flowable.datasource.password=${spring.datasource.password}

# ------------------------------------------------------------------------------
# H2 (Development/Testing)
# ------------------------------------------------------------------------------
# Uncomment for H2 and comment PostgreSQL above:
# flowable.datasource.jdbc-url=jdbc:h2:file:${store.basepath}/lrharvester_flowable;DB_CLOSE_DELAY=-1
# flowable.datasource.username=${spring.datasource.username}
# flowable.datasource.password=${spring.datasource.password}

# ------------------------------------------------------------------------------
# SQLite (Development/Testing)
# ------------------------------------------------------------------------------
# Uncomment for SQLite and comment PostgreSQL above:
# flowable.datasource.jdbc-url=jdbc:sqlite:${store.basepath}/lrharvester_flowable.db
# flowable.datasource.username=${spring.datasource.username}
# flowable.datasource.password=${spring.datasource.password}

# Driver is auto-detected from jdbc-url
# Only set explicitly if auto-detection fails:
# flowable.datasource.driver-class-name=${spring.datasource.driver-class-name}

# Flowable connection pool settings (separate from main pool)
flowable.datasource.hikari.minimum-idle=2
flowable.datasource.hikari.maximum-pool-size=10
flowable.datasource.hikari.connection-timeout=30000
flowable.datasource.hikari.idle-timeout=600000
flowable.datasource.hikari.max-lifetime=1800000

# Automatically create/update Flowable tables on startup
# Options: true (auto-create/update), false (no changes), create-drop (for testing)
# Set to 'false' in production once tables are created
flowable.database.schema-update=true

# ------------------------------------------------------------------------------
# Async Executor Configuration
# ------------------------------------------------------------------------------

# Enable async executor for background jobs
flowable.async-executor-activate=true

# Number of retries for failed jobs (0 = no retries, good for clean shutdown)
flowable.async-executor.number-of-retries=0

# Thread pool configuration
flowable.async-executor.core-pool-size=2
flowable.async-executor.max-pool-size=10

# ------------------------------------------------------------------------------
# ID Generator
# ------------------------------------------------------------------------------

# Use UUID for process instance IDs (recommended for distributed systems)
flowable.id-generator=uuid
